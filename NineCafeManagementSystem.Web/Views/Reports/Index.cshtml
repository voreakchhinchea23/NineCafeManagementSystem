
    @model MonthlyReportVM
    @{
        ViewData["Title"] = "Monthly Report";
    }

    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="h4 mb-0">Monthly Report</h1>
    </div>

    <!-- Month/Year Selector -->
    <form method="get" class="row mb-4 g-2">
        <div class="col-auto">
            <select name="month" class="form-select">
                @foreach (var m in Model.AvailableMonths)
                {
                    <option value="@m" selected="@(m == Model.Month)">@DateTimeFormatInfo.CurrentInfo.GetMonthName(m)</option>
                }
            </select>
        </div>
        <div class="col-auto">
            <select name="year" class="form-select">
                @foreach (var y in Model.AvailableYears)
                {
                    <option value="@y" selected="@(y == Model.Year)">@y</option>
                }
            </select>
        </div>
        <div class="col-auto">
            <button type="submit" class="btn btn-outline-primary btn-sm">Go</button>
        </div>

    
    </form>

<!--export to excel-->
<div class="col-auto mb-4">
    <a asp-action="ExportMonthly"
       asp-route-year="@Model.Year"
       asp-route-month="@Model.Month"
       class="btn btn-success">
        <i class="bi bi-file-earmark-spreadsheet"></i> Export to Excel
    </a>
</div>


    <!-- Report Summary Cards -->
    <div class="row g-3">
        <!-- Income -->
        <div class="col-md-4">
            <div class="card text-white bg-success">
                <div class="card-body text-center py-3">
                    <h6 class="text-uppercase">Total Income</h6>
                    <h5 class="mb-1">@Model.TotalIncome.ToString("N0") Riel</h5>
                    <p class="mb-0">@Model.TotalIncomeUsd.ToString("C2")</p>
                </div>
            </div>
        </div>

        <!-- Expenses -->
        <div class="col-md-4">
            <div class="card text-white bg-danger">
                <div class="card-body text-center py-3">
                    <h6 class="text-uppercase">Total Expenses</h6>
                    <h5 class="mb-1">@Model.TotalExpense.ToString("N0") Riel</h5>
                    <p class="mb-0">@Model.TotalExpensesUsd.ToString("C2")</p>
                </div>
            </div>
        </div>

        <!-- Profit -->
        <div class="col-md-4">
            <div class="card text-white @(Model.Profit >= 0 ? "bg-primary" : "bg-warning")">
                <div class="card-body text-center py-3">
                    <h6 class="text-uppercase">Profit</h6>
                    <h5 class="mb-1">@Model.Profit.ToString("N0") Riel</h5>
                    <p class="mb-0">@Model.ProfitUsd.ToString("C2")</p>
                </div>
            </div>
        </div>
    </div>

    <div class="mt-4">
        <h5>Report for: @Model.MonthName @Model.Year</h5>
    </div>